# ------------------------------------------------------------------------
# OWASP CRS Plugin
# Copyright (c) 2021-2024 CRS project. All rights reserved.
#
# The OWASP CRS plugins are distributed under
# Apache Software License (ASL) version 2
# Please see the enclosed LICENSE file for full details.
# ------------------------------------------------------------------------

# OWASP CRS Plugin
# Plugin name: body-decompress-plugin
# Plugin description: On-the-fly decompression of RESPONSE_BODY
# Rule ID block base: 9,503,000 - 9,503,999
# Plugin version: 1.0.0

SecRuleUpdateTargetById 950130 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 950140 TX:RESPONSE_BODY_DECOMPRESSED

SecRuleUpdateTargetById 951100 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 951110 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 951120 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 951130 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 951140 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 951150 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 951160 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 951170 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 951180 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 951190 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 951200 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 951210 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 951220 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 951230 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 951240 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 951250 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 951260 TX:RESPONSE_BODY_DECOMPRESSED

SecRuleUpdateTargetById 952100 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 952110 TX:RESPONSE_BODY_DECOMPRESSED

SecRuleUpdateTargetById 953100 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 953110 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 953120 TX:RESPONSE_BODY_DECOMPRESSED

SecRuleUpdateTargetById 954100 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 954110 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 954120 TX:RESPONSE_BODY_DECOMPRESSED
# Directive SecRuleUpdateTargetById, unfortunately, doesn't support 'OFFSET'
# like SecRuleUpdateActionById, so affected rules are commented out - keeping it
# here just to see what is NOT handled by this plugin.
#SecRuleUpdateTargetById 954130:1 TX:RESPONSE_BODY_DECOMPRESSED

SecRuleUpdateTargetById 955100 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 955110 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 955120 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 955130 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 955140 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 955150 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 955160 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 955170 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 955180 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 955190 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 955200 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 955210 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 955220 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 955230 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 955240 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 955250 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 955260 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 955270 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 955280 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 955290 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 955300 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 955310 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 955320 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 955330 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 955340 TX:RESPONSE_BODY_DECOMPRESSED
SecRuleUpdateTargetById 955350 TX:RESPONSE_BODY_DECOMPRESSED
